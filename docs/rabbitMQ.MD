### https://hutool.cn/

#Bibbon
1. Ribbon是本地负载均衡的客户端VS Nginx服务端负载均衡的区别
* Nginx是服务器的负载均衡，客户端所有的请求都会交给Nginx，然后由Nginx 转发请求。
* Ribbon本地负载均衡，在调用服务接口的时，会在注册中上获取注册信息服务列表之后，缓存到JVM本地，从而在本地完成RPC的调用过程。
2. 负载均衡+RestTemplate调用
* RoundRobinRule 轮询
* RandomRule 随机
* RetryRule 重试
* WeightedRestponseTimeRule 相应速度越快的实例选择权重越大，越容易被选择。
* BastAvailableRule 过滤掉不好的服务器。
3. 原理
List<机器>.getSize() % 机器的台数 = 执行机器的下标。

#OpenFeign
1. OpenFeign是什么
* Feign是一个声明式的Web服务客户端，让编写web服务变得更加容易，只需创建一个接口并在接口上面添加注解即可。


2 Feign的日志级别 有四种日志级别
* NONE 默认，不显示任何日志。
* BASIC 仅记录请求方法，url，响应状态码及执行时间。
* HEADERS 除了BASIC的信息外，还有请求和响应的信息。
* FULL 除了HEADERS中农定义的信息外，还有请求和响应的正文元素。

# Hystrix
1. 功能
* 服务降级
* 服务熔断
* 接近实时的监控
2. 重要的概念
* 服务降级：服务器忙，请稍后重试，不让客户端等待并like返回一个友好提示，fallBack
  * 程序运行异常
  * 超时
  * 服务熔断触发降级
  * 线程池/信号量打满，也会导致服务降级，
* 服务熔断：类似于保险丝，到达最大服务访问后，直接拒绝访问，拉闸限电，然后调用服务降级的方法返回提示。
  * 服务的降级》》进而熔断》》恢复调用链路
* 服务限流：秒杀高并发等操作，严禁一窝蜂的拥挤，大家排队，1秒钟N个，有序进行。

* 服务降级
  * 上图故意制造两个异常；
  * int age = 10/0 计算异常
  * 我们能接受3秒钟，它运行5秒钟，超时异常。

* 服务熔断
    *  是否开启断路器
    *  请求次数
    *  时间窗口
    *  失败率达到多少后跳闸

**熔断的总结**
 * 熔断打开：请求不在调用当前服务，内部设置时钟一般为MTTR（平均故障处理时间），当打开时长达所设时钟则进入版熔断状态。
 * 熔断关闭：熔断关闭不会对服务进行熔断。
 * 熔断半开：部分请求根据规则调用当前服务，如果请求成功且符合规则，认为当前服务恢复正常，关闭熔断。
1. 当满足一定的阀值得时候（默认10秒钟内20个请求次数）
2. 当失败率达到一定的时候（默认10秒钟内超过50%的庆祝失败）
3. 到达以上的阀值断路器将开启。
4. 当开启的时候，所有请求都不会进行转发.
5. 一段时间后（默认是5秒钟），这个时候断路器是半开状态，会让其中的一个请求进行转发。如果成功，断路器会关闭，若失败，继续关闭。重复4和5.

# GateWay
1. 三大核心概念
 * 路由：构建网关的基本模块，它由ID，目标URI，一系列的断言和过滤器组成，如果断言为true，则匹配该路由。
 * 断言：开发人员可以匹配http请求中的所有内容（例如请求头或请求参数），如果请求与断言相匹配则进行路由。
 * 过滤：指的是spring框架的GatewayFilter的实例，使用过滤器，可使请求在路有钱或者之后对请求进行修改。
 
客户端向spring cloud gateway 发请求，在gateway handler mapping中找到与请求匹配的路由，将其反送到gateway web handler。
核心是路由转发+执行过滤链

**predicate**

时间过滤 after befor between
cookie 过滤
header 过滤
host 过滤
method ：get / post
path ： 路径
query ： 带查询

**filter**

# Sentinel 实现熔断与限流
单独的一个组件，可以独立出来
直接界面化的细粒度统一配置

***流控模式***
